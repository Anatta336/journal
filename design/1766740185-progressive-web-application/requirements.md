# Progressive Web Application
The frontend should be reworked to be a Progressive Web Application (PWA).

It should fetch *all* data from the backend. Not just the metadata about entries, but their full content. All data should be downloaded as soon as possible to ensure full offline availability. Only active entries should be synced for offline use; the trash is for manual recovery on the server.

A header should be added to the top of the app. This header should contain a small coloured indicator to show whether the app is currently in "Offline" or "Online" mode. While a sync is in progress, it should also display a "Syncing..." status. The "Entry List" should show a loading state if it's empty and a sync is in progress. The header should also contain a link to the "Settings" page.

A user should be able to use the application entirely offline.

Changes made by the user while offline should be sent back to the server when connectivity is restored. This includes deletions, which should be tracked and synced. The local storage should mimic the file storage used on the server as closely as possible. A deleted entry should have a `trashed` flag set to true, which is equivalent to moving it to the `.trash` directory on the server. During sync, the client should send the list of entries with the `trashed` flag set to true to the server for deletion. The application should support background sync using the Web Background Sync API for reliable syncing of pending changes (saves/deletes) even if the user closes the tab immediately after an action. For browsers that do not support the Web Background Sync API (e.g., Safari), the app should fall back to attempting a sync when the app is next opened or when the user regains connectivity while the app is open.

The app should attempt to sync automatically after each entry save, and every 5 minutes when online. To optimize syncing, the app should use a hashing mechanism (using SHA-256):
- Each entry should have a hash of its content stored in its frontmatter. The client is responsible for calculating this hash (excluding the frontmatter itself) and including it when sending the entry to the server. The server should store this hash as provided.
- A global hash should be generated by sorting the entry IDs alphabetically, concatenating their individual hashes in that order, and then hashing the resulting string.
- When syncing, the app should first compare the global hash with the server. If they match, no further action is needed.
- If they differ, the app should compare individual entry hashes to identify and transfer only the changed entries.

There should be a manual "sync now" button and the UI should display the sync status (e.g., when the last successful sync occurred) on a dedicated "Settings" page. This page should be added to the application's routing and is accessible via a link in the header.

For now we will handle any conflicts by using the version with the most recent `lastUpdated` timestamp. The `lastUpdated` timestamp should be updated by the client whenever an entry is modified or created, and should always be in UTC. The entire entry with the most recent timestamp will overwrite the older version (no complex merging strategies). This applies even if it means restoring a previously deleted entry. Conflict resolution should happen silently.

The application should display the total storage used (in bytes) by the PWA on the "Settings" page. This should include the total storage used by the entire origin, including both the data (IndexedDB) and the application assets (Cache Storage). No specific storage limits are required.

For security, we will assume the device's own security (lock screen) is sufficient; no additional authentication layer is required for now.

The PWA should be installable on mobile devices. Especially focused on Android.
